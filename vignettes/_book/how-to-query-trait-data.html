<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Get Weather Data</title>
  <meta name="description" content="Get Weather Data">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Get Weather Data" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Get Weather Data" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="getting-started.html">
<link rel="next" href="may-2018-season-6-summary.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="part"><span><b>Secton 1: Vignettes</b></span></li>
<li class="chapter" data-level="1" data-path="vignettes-introduction.html"><a href="vignettes-introduction.html"><i class="fa fa-check"></i><b>1</b> Vignettes Introduction</a></li>
<li class="chapter" data-level="2" data-path="accessing-trait-data-in-r.html"><a href="accessing-trait-data-in-r.html"><i class="fa fa-check"></i><b>2</b> Accessing trait data in R</a></li>
<li class="chapter" data-level="3" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>3</b> Introduction</a></li>
<li class="chapter" data-level="4" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>4</b> Getting Started</a></li>
<li class="chapter" data-level="5" data-path="how-to-query-trait-data.html"><a href="how-to-query-trait-data.html"><i class="fa fa-check"></i><b>5</b> How to query trait data</a><ul>
<li class="chapter" data-level="5.1" data-path="how-to-query-trait-data.html"><a href="how-to-query-trait-data.html#setting-options"><i class="fa fa-check"></i><b>5.1</b> Setting options</a></li>
<li class="chapter" data-level="5.2" data-path="how-to-query-trait-data.html"><a href="how-to-query-trait-data.html#an-example-season-6-canopy-height-data"><i class="fa fa-check"></i><b>5.2</b> An example: Season 6 canopy height data</a></li>
<li class="chapter" data-level="5.3" data-path="how-to-query-trait-data.html"><a href="how-to-query-trait-data.html#time-series-of-canopy-height"><i class="fa fa-check"></i><b>5.3</b> Time series of canopy height</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="may-2018-season-6-summary.html"><a href="may-2018-season-6-summary.html"><i class="fa fa-check"></i><b>6</b> May 2018 Season 6 Summary</a></li>
<li class="chapter" data-level="7" data-path="how-to-query-other-seasons-traits-and-dates.html"><a href="how-to-query-other-seasons-traits-and-dates.html"><i class="fa fa-check"></i><b>7</b> How to query other seasons, traits, and dates</a></li>
<li class="chapter" data-level="8" data-path="objective-to-be-able-to-demonstrate-how-to-get-terra-ref-meteorological-data.html"><a href="objective-to-be-able-to-demonstrate-how-to-get-terra-ref-meteorological-data.html"><i class="fa fa-check"></i><b>8</b> Objective: To be able to demonstrate how to get TERRA REF meteorological data</a><ul>
<li class="chapter" data-level="8.0.1" data-path="objective-to-be-able-to-demonstrate-how-to-get-terra-ref-meteorological-data.html"><a href="objective-to-be-able-to-demonstrate-how-to-get-terra-ref-meteorological-data.html#using-the-api-to-get-data"><i class="fa fa-check"></i><b>8.0.1</b> Using the API to get data</a></li>
<li class="chapter" data-level="8.0.2" data-path="objective-to-be-able-to-demonstrate-how-to-get-terra-ref-meteorological-data.html"><a href="objective-to-be-able-to-demonstrate-how-to-get-terra-ref-meteorological-data.html#the-structure-of-the-database"><i class="fa fa-check"></i><b>8.0.2</b> The structure of the database</a></li>
<li class="chapter" data-level="8.0.3" data-path="objective-to-be-able-to-demonstrate-how-to-get-terra-ref-meteorological-data.html"><a href="objective-to-be-able-to-demonstrate-how-to-get-terra-ref-meteorological-data.html#creating-the-urls-for-all-data-table-types"><i class="fa fa-check"></i><b>8.0.3</b> Creating the URLs for all data table types</a></li>
<li class="chapter" data-level="8.0.4" data-path="objective-to-be-able-to-demonstrate-how-to-get-terra-ref-meteorological-data.html"><a href="objective-to-be-able-to-demonstrate-how-to-get-terra-ref-meteorological-data.html#download-data-using-the-command-line"><i class="fa fa-check"></i><b>8.0.4</b> Download data using the command line</a></li>
<li class="chapter" data-level="8.0.5" data-path="objective-to-be-able-to-demonstrate-how-to-get-terra-ref-meteorological-data.html"><a href="objective-to-be-able-to-demonstrate-how-to-get-terra-ref-meteorological-data.html#read-in-data-using-r"><i class="fa fa-check"></i><b>8.0.5</b> Read in data using R</a></li>
<li class="chapter" data-level="8.0.6" data-path="objective-to-be-able-to-demonstrate-how-to-get-terra-ref-meteorological-data.html"><a href="objective-to-be-able-to-demonstrate-how-to-get-terra-ref-meteorological-data.html#plot-data-using-r"><i class="fa fa-check"></i><b>8.0.6</b> Plot data using R</a></li>
<li class="chapter" data-level="8.0.7" data-path="objective-to-be-able-to-demonstrate-how-to-get-terra-ref-meteorological-data.html"><a href="objective-to-be-able-to-demonstrate-how-to-get-terra-ref-meteorological-data.html#get-all-available-weather-variables"><i class="fa fa-check"></i><b>8.0.7</b> Get all available weather variables</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="objective-to-be-able-to-demonstrate-how-to-locate-and-retrieve-rgb-image-files.html"><a href="objective-to-be-able-to-demonstrate-how-to-locate-and-retrieve-rgb-image-files.html"><i class="fa fa-check"></i><b>9</b> Objective: To be able to demonstrate how to locate and retrieve RGB image files</a><ul>
<li class="chapter" data-level="9.1" data-path="objective-to-be-able-to-demonstrate-how-to-locate-and-retrieve-rgb-image-files.html"><a href="objective-to-be-able-to-demonstrate-how-to-locate-and-retrieve-rgb-image-files.html#locating-the-images"><i class="fa fa-check"></i><b>9.1</b> Locating the images</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="retrieving-the-images.html"><a href="retrieving-the-images.html"><i class="fa fa-check"></i><b>10</b> Retrieving the images</a></li>
<li class="chapter" data-level="11" data-path="retrieving-sensor-names.html"><a href="retrieving-sensor-names.html"><i class="fa fa-check"></i><b>11</b> Retrieving sensor names</a></li>
<li class="chapter" data-level="12" data-path="synthesis-vignette.html"><a href="synthesis-vignette.html"><i class="fa fa-check"></i><b>12</b> Synthesis Vignette</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Get Weather Data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="how-to-query-trait-data" class="section level1">
<h1><span class="header-section-number">5</span> How to query trait data</h1>
<div id="setting-options" class="section level2">
<h2><span class="header-section-number">5.1</span> Setting options</h2>
<p>The function that you will be using to perform your queries is <code>betydb_query</code>. Options can be set to reduce the number of arguments that need to be passed into the function.</p>
<p>Note: the <code>betydb_key</code> option only needs to be set when accessing non-public data. We will be using public data, so this option does not need to be set. However, when needed, pass in the API key that you were assigned when you first registered for access to the TERRA REF database. The key should be kept private and saved to a file named <code>.betykey</code> in your current directory. If you are having trouble locating your API key, you can go to <a href="https://terraref.ncsa.illinois.edu/bety/users" class="uri">https://terraref.ncsa.illinois.edu/bety/users</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">options</span>(<span class="co"># betydb_key = &#39;Your API Key&#39;, # to access non-public data</span>
        <span class="dt">betydb_url =</span> <span class="st">&quot;https://terraref.ncsa.illinois.edu/bety/&quot;</span>,
        <span class="dt">betydb_api_version =</span> <span class="st">&#39;v1&#39;</span>)</code></pre></div>
</div>
<div id="an-example-season-6-canopy-height-data" class="section level2">
<h2><span class="header-section-number">5.2</span> An example: Season 6 canopy height data</h2>
<p>The following is an example of how to query season 6, canopy height data for May 2018.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">canopy_height &lt;-<span class="st"> </span><span class="kw">betydb_query</span>(<span class="dt">table     =</span> <span class="st">&quot;search&quot;</span>, 
                              <span class="dt">trait     =</span> <span class="st">&quot;canopy_height&quot;</span>, 
                              <span class="dt">sitename  =</span> <span class="st">&quot;~Season 6&quot;</span>,
                              <span class="dt">date      =</span> <span class="st">&quot;~2018 May&quot;</span>,
                              <span class="dt">limit     =</span>  <span class="st">&quot;none&quot;</span>)</code></pre></div>
<p>A breakdown of the above query:</p>
<ul>
<li><code>table = &quot;search&quot;</code>
<ul>
<li>Specify a table to query with the <code>table</code> parameter. Trait data may be queried using the <code>search</code> table.</li>
</ul></li>
<li><code>trait = &quot;canopy_height&quot;</code>
<ul>
<li>Specify the trait of interest with the <code>trait</code> parameter.</li>
<li>Trait names must be expressed exactly as they are in the TERRA REF databse. So passing in <code>Canopy height</code> instead of <code>canopy_height</code> would give NULL results.</li>
<li>More information on how to determine available traits for a season can be found below under <code>How to query other seasons, traits, and dates</code>.</li>
</ul></li>
<li><code>sitename = &quot;~Season 6&quot;</code>
<ul>
<li>Indicate the sites that you would like to query using the <code>sitename</code> parameter.</li>
<li>A tilde <code>~</code> is used in this query to get all sitenames that contain <code>Season 6</code></li>
</ul></li>
<li><code>date = &quot;~2018 May&quot;</code>
<ul>
<li>Indicate the date of data collection using the <code>date</code> parameter.</li>
<li>A tilde <code>~</code> is used in this query to get all records that have a collection date that contains <code>2018 May</code></li>
</ul></li>
<li><code>limit = &quot;none&quot;</code>
<ul>
<li>Indicate the maximum numnber of records you would like returned with the <code>limit</code> parameter. We want all records for this query, so we set limit to <code>none</code>.</li>
</ul></li>
</ul>
</div>
<div id="time-series-of-canopy-height" class="section level2">
<h2><span class="header-section-number">5.3</span> Time series of canopy height</h2>
<p>Here is an example of how to visualize the data that we just queried.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#load in necessary packages</span>
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(lubridate)

<span class="co">#plot a time series of canopy height </span>
<span class="kw">ggplot</span>(<span class="dt">data =</span> canopy_height,
       <span class="kw">aes</span>(<span class="dt">x =</span> lubridate<span class="op">::</span><span class="kw">yday</span>(lubridate<span class="op">::</span><span class="kw">ymd_hms</span>(raw_date)), <span class="dt">y =</span> mean)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">position =</span> <span class="kw">position_jitter</span>(<span class="dt">width =</span> <span class="fl">0.1</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Day of Year&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Plant Height&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">color =</span> <span class="kw">guide_legend</span>(<span class="dt">title =</span> <span class="st">&#39;Genotype&#39;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()</code></pre></div>
<p><img src="_main_files/figure-html/canopy_height_plot-1.png" width="672" /></p>
<p></p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="getting-started.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="may-2018-season-6-summary.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
